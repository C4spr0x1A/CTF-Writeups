# CTF Writeup: Middle of Nowhere

**Author:** Mohamed Armaoui - C4spr0x1A

## Challenge Details
| Category       | Web Exploitation |
|----------------|------------------|
| Challenge Name | Middle of Nowhere |
| CTF Event      | Blitz CTF 2025 |
| Flag           | `Blitz{N3x7js_M1ddl3w4r3_Byyyyp4sssssss}` |

## Solution

This writeup details my approach to solving the "Middle of Nowhere" CTF challenge, which involved exploiting a Next.js web application to find a hidden flag.

### 1. Initial Reconnaissance

The challenge presented a login page at `https://middleofnowhere-dhsbd8.blitzhack.xyz/login`. My first step was to examine the basic web server configuration and common files.

*   Checking `robots.txt`: I used `curl` to check for a `robots.txt` file, hoping to find disallowed directories or hidden paths.
    `curl https://middleofnowhere-dhsbd8.blitzhack.xyz/robots.txt`

    The `robots.txt` file revealed one interesting entry:

    ```
    User-agent: *
    Disallow: /admin
    Allow: /
    ```

    This indicated an `/admin` path, which is typically a restricted area.

*   Attempting to access `/admin`: Navigating directly to `/admin` resulted in a redirection back to `/login`, confirming it was protected.
    `curl https://middleofnowhere-dhsbd8.blitzhack.xyz/admin`

    Output:

    `"/login"`

*   Checking `sitemap.xml`: I also checked for `sitemap.xml` in case it revealed other paths, but it returned a 404.

### 2. Analyzing Client-Side Code

Given that the application is built with Next.js (evident from the `_next` paths in the HTML source), a significant portion of the logic, including potentially sensitive information, could reside in the client-side JavaScript bundles. I focused on the main JavaScript file loaded by the login page.

*   Identifying the main JavaScript file: From the login page's source, I noted a script tag pointing to `/_next/static/chunks/pages/login-7593437a57f70c0b.js` (the hash might vary but the login part is key).

*   Fetching the JavaScript file: I used `curl` to download the content of this JavaScript file for local analysis.
    `curl https://middleofnowhere-dhsbd8.blitzhack.xyz/_next/static/chunks/pages/login-7593437a57f70c0b.js`

*   Searching for credentials: Upon reviewing the minified JavaScript, I looked for keywords like "username", "password", "admin", "login", or any string comparisons that might reveal hardcoded credentials. After careful inspection, I found the following line within a function that appeared to handle form submission:
    `"adm1n"===s&&"BlitZ123Hackzzzzzzzz"===a?((0,d.setCookie)("auth","BlitZHackzzzzzzzz",{maxAge:3600}),e.push("/admin")):(i("Invalid credentials"),h(!1));`

    This line clearly shows a client-side check for a hardcoded username `adm1n` and password `BlitZ123Hackzzzzzzzz`. If these match, a cookie named `auth` is set with the value `BlitZHackzzzzzzzz`, and the user is redirected to `/admin`.

### 3. Exploitation: Bypassing Authentication

Since the authentication logic was entirely client-side, I could bypass it by directly setting the `auth` cookie and accessing the `/admin` page.

*   Attempting login with `curl` (initial failure): My first attempt to "log in" by POSTing the credentials via `curl` failed with a "405 Method Not Allowed" error. This confirmed that there was no server-side endpoint processing the form submission directly; it was purely a client-side validation.

*   Directly accessing `/admin` with the cookie: The successful bypass involved using `curl` to request the `/admin` page while supplying the `auth` cookie with the correct value.
    `curl -b "auth=BlitZHackzzzzzzzz" https://middleofnowhere-dhsbd8.blitzhack.xyz/admin`

## Flag Obtained!

This request successfully granted access to the admin dashboard. The flag was prominently displayed on the page:

`Blitz{N3x7js_M1ddl3w4r3_Byyyyp4sssssss}`
